{{/* Local shortcode to render experience entries independent of theme.
   Renders all pages of type "experience" ordered by date desc.
*/}}

{{ $sectionId := .Get "sectionId" | default "experience-list-shortcode" }}
{{ $padding := .Get "padding" }}
{{ $title := .Get "title" | default "" }}
{{ $containerClass := "" }}
{{ if eq $padding "true" }}
  {{ $containerClass = "container" }}
{{ end }}

<section id="{{ $sectionId }}" class="section-experience section {{ $containerClass }}">
  {{ if $title }}<h2 class="section__title mb-4">{{ $title }}</h2>{{ end }}

  {{ $xp := (where .Site.RegularPages.ByDate "Type" "experience") }}
  {{ $xpCount := len $xp }}

  {{ range $index, $element := first $xpCount (sort $xp "Date" "desc") }}
    <div class="experience">
      <div class="experience__meta">
        <div class="experience__date">{{ .Params.duration }}</div>
        <div class="experience__title">{{ .Params.jobTitle }}</div>
        <div class="experience__company">{{ .Params.company }}<span class="experience__location"> â€” {{ .Params.location }}</span></div>
      </div>
      <div class="experience__description">
        <h3>{{ .Params.title }}</h3>
        {{ .Content | safeHTML }}
      </div>
    </div>
    {{ if ne $index (sub $xpCount 1) }}
      <hr class="my-4">
    {{ end }}
  {{ end }}
</section>

